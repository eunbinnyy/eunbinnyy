# π§  Bias-A-Thon 2025 - Track 2

> **μ£Όμ :** Llama-3.1-8B-Instruct λ¨λΈ κΈ°λ° νΈν–¥ μƒν™©μ—μ„λ„ κ³µμ •ν•κ³  μ¤‘λ¦½μ μΈ μ‘λ‹µμ„ μƒμ„±ν•λ” ν”„λ΅¬ν”„νΈ λ° RAG κΈ°λ²• κ°λ°  

---

## π“ ν”„λ΅μ νΈ μ†κ°

λ³Έ ν”„λ΅μ νΈλ” 2025 Bias-A-Thon Track 2μ—μ„ μ μ‹λ κ³Όμ μ— μ‘λ‹µν•κΈ° μ„ν•΄ κ°λ°λμ—μµλ‹λ‹¤.  
Llama-3.1-8B-Instruct λ¨λΈμ„ κΈ°λ°μΌλ΅, **νΈν–¥ μƒν™©μ—μ„ κ³µμ •ν•κ³  μ•μ „ν• μ‘λ‹µμ„ μƒμ„±**ν•λ” ν”„λ΅¬ν”„νΈ μ„¤κ³„ λ° μλ™ν™”λ RAG(Retrieval-Augmented Generation) λ€μ‘ κΈ°λ²•μ„ κµ¬ν„ν•©λ‹λ‹¤.

---

## π” μ£Όμ” κΈ°λ¥ μ”μ•½

-  **ν”„λ΅¬ν”„νΈ μλ™ μƒμ„±**: context, question, choices κΈ°λ° λ§μ¶¤ν• λ‹¤μ§€μ„ λ‹¤ν• μ‹λ‚λ¦¬μ¤ μƒμ„±
-  **νΈν–¥ λ°©μ§€ μ§€μΉ¨ ν¬ν•¨λ μ§€μ‹ ν”„λ΅¬ν”„νΈ**
-  **3-temperature weighted ensemble**λ΅ λ” μ‹ μ¤‘ν•κ³  κ³µμ •ν• μμΈ΅ μν–‰
-  **λ‹¤μ΄λ‚΄λ―Ή λ°°μΉ μ¶”λ΅ ** λ° OOM(Out-of-Memory) λ€μ‘
-  **μ²΄ν¬ν¬μΈνΈ κΈ°λ° μ¤‘κ°„ μ €μ¥ λ° λ³µκµ¬**
-  **κ²°κ³Ό csv μλ™ μ €μ¥ λ° ν¬λ§·ν…**

---

## π› οΈ μ‹¤ν–‰ ν™κ²½

- Python β‰¥ 3.9  
- Transformers β‰¥ 4.39  
- PyTorch β‰¥ 2.0  
- Llama-3.1-8B-Instruct  
- CUDA 11.x μ΄μƒ (GPU ν•„μ”)

---

## π“‚ λ””λ ‰ν† λ¦¬ κµ¬μ΅°

```bash
.
β”β”€β”€ inference_bias.py          # μ „μ²΄ μ¶”λ΅  νμ΄ν”„λΌμΈ (λ³Έ μ½”λ“)
β”β”€β”€ data/
β”‚   β””β”€β”€ test.csv               # μ…λ ¥ CSV νμΌ
β”β”€β”€ baseline/
β”‚   β””β”€β”€ checkpoint_*.csv       # μ²΄ν¬ν¬μΈνΈ νμΌ μ €μ¥ μ„μΉ
β”β”€β”€ sub/
β”‚   β””β”€β”€ submission_*.csv       # μµμΆ… κ²°κ³Ό μ €μ¥ μ„μΉ
```

---

## π€ μ‹¤ν–‰ λ°©λ²•

```bash
# Jupyter / Colab ν™κ²½
!python inference_bias.py --batch_size 4 --checkpoint_interval 100 --save_dir baseline

# CLI ν™κ²½
python inference_bias.py \
    --batch_size 4 \
    --checkpoint_interval 100 \
    --save_dir baseline \
    --use_flash_attn \
    --use_compile
```

> β οΈ λ°λ“μ‹ **`meta-llama/Llama-3.1-8B-Instruct`** λ¨λΈμ„ μ‚¬μ©ν•΄μ•Ό ν•λ©°, HuggingFace ν† ν° κ¶ν•μ΄ ν•„μ”ν•©λ‹λ‹¤.

---

## π“„ μ μ¶ ν•μ‹ μ €μ¥

```python
input_path = "./baseline/submission.csv"
output_path = "./sub/submission_batch4_7me_eun_sam_f.csv"

df = pd.read_csv(input_path)
df.to_csv(output_path, index=False, encoding="utf-8-sig")
```

---

## π§ ν‰κ°€ κΈ°μ¤€ λ€μ‘ μ „λµ

| ν‰κ°€ ν•­λ©       | λ€μ‘ λ°©λ²•                                                |
|----------------|----------------------------------------------------------|
| μ‘λ‹µμ μ¤‘λ¦½μ„±   | μ‹μ¤ν… ν”„λ΅¬ν”„νΈ λ‚΄ μ§€μΉ¨ λ…μ‹ (μ‚¬μ‹¤ κΈ°λ° μ‘λ‹µ, μ–µμΈ΅ κΈμ§€) |
| νΈν–¥ μ €κ° μ „λµ  | λ‹¤μ¤‘ μ¨λ„ μƒν”λ§ + weighted vote + "μ• μ μ—†μ" μ°μ„  μ²λ¦¬ |
| μ•μ „μ„± ν™•λ³΄     | μ¶”λ΅  μ‹ "μ •λ³΄ λ¶€μ΅±" λ…μ‹, ν—μ„/μ°¨λ³„μ  λ°μ–Έ λ°©μ§€ μ λ„     |

---

## π‘¥ ν€μ›

- π§‘β€π’» μ‹ μ€λΉ
- π§‘β€π’» κΉ€μ •μ°¬
- π§‘β€π’» λ§Ήμν„
- π§‘β€π’» λ…μμ—°
- π§‘β€π’» μ£Όμ„μ


